<div class="order-container">
  <!-- Progress Steps -->
  <div class="progress-container">
    <div class="progress-steps">
      <div class="step" [class.active]="currentStep >= 1" [class.completed]="isStepCompleted(1)">
        <div class="step-number">1</div>
        <div class="step-label">Select Date</div>
      </div>
      <div class="step-connector" [class.active]="currentStep > 1"></div>
      <div class="step" [class.active]="currentStep >= 2" [class.completed]="isStepCompleted(2)">
        <div class="step-number">2</div>
        <div class="step-label">Choose Items</div>
      </div>
      <div class="step-connector" [class.active]="currentStep > 2"></div>
      <div class="step" [class.active]="currentStep >= 3" [class.completed]="isStepCompleted(3)">
        <div class="step-number">3</div>
        <div class="step-label">Payment</div>
      </div>
    </div>
  </div>

  <!-- Order Confirmation Success -->
  <div *ngIf="orderConfirmed" class="order-success">
    <div class="success-content">
      <div class="success-icon">‚úÖ</div>
      <h2>Order Confirmed!</h2>
      <div class="order-summary">
        <p><strong>Order ID:</strong> {{ orderDetails?.orderId }}</p>
        <p><strong>Date:</strong> {{ selectedDate | date:'fullDate' }}</p>
        <p><strong>Total Amount:</strong> ‚Çπ{{ getCartTotal() }}</p>
        <p><strong>Payment Status:</strong> 
          <span [class]="orderDetails?.status === 'paid' ? 'status-paid' : 'status-cod'">
            {{ orderDetails?.status === 'paid' ? 'Paid Online' : 'Cash on Delivery' }}
          </span>
        </p>
      </div>
      <div class="success-actions">
        <button class="btn btn-primary" (click)="goHome()">Back to Home</button>
        <button class="btn btn-secondary" (click)="resetOrder()">Place Another Order</button>
      </div>
    </div>
  </div>

  <!-- Step Content -->
  <div *ngIf="!orderConfirmed" class="step-content">
    
    <!-- Step 1: Date Selection -->
    <div *ngIf="currentStep === 1" class="date-selection">
      <div class="step-header">
        <h2>Select Your Preferred Date</h2>
        <p>Choose when you'd like to receive your homemade meal</p>
      </div>
      
      <div class="date-picker-container">
        <label for="checkin-date">Delivery Date</label>
        <input 
          type="date" 
          id="checkin-date"
          [(ngModel)]="selectedDate"
          [min]="minDate"
          (change)="onDateChange()"
          class="date-input"
          required
        />
      </div>

      <!-- Daily Menu Preview -->
<div *ngIf="selectedDayMenu.length > 0" class="day-menu-preview">
  <h3>Menu for {{ selectedDayName }}</h3>
  <ul>
    <li *ngFor="let item of selectedDayMenu">{{ item }}</li>
  </ul>
</div>


      <div class="step-actions">
        <button 
          class="btn btn-primary" 
          [disabled]="!selectedDate"
          (click)="nextStep()"
        >
          Continue to Menu
          <span>‚Üí</span>
        </button>
      </div>
    </div>

    <!-- Step 2: Menu Selection -->
   <!-- Step 2: Menu Selection -->
<div *ngIf="currentStep === 2" class="menu-selection">
  <div class="step-header">
    <h2>Choose Your Items</h2>
    <p>Select from our authentic South Indian menu</p>
  </div>

  <!-- Daily Menu Preview -->
  <div *ngIf="selectedDayMenu.length > 0" class="day-menu-preview">
    <h3>üìÖ Menu for {{ selectedDayName }}</h3>
    <ul>
      <li *ngFor="let item of selectedDayMenu">{{ item }}</li>
    </ul>
  </div>

  <div class="menu-grid">
    <div class="menu-item-card" *ngFor="let item of availableItems">
      <div class="item-info">
        <h3>{{ item.name }}</h3>
        <p class="item-price">‚Çπ{{ item.price }}</p>
      </div>
      <button class="btn btn-accent" (click)="addToCart(item)">
        Add to Cart
      </button>
    </div>
  </div>

  <!-- Cart Summary -->
  <div *ngIf="cartItems.length > 0" class="cart-summary">
    <h3>Your Order ({{ getCartItemCount() }} items)</h3>
    <div class="cart-items">
      <div class="cart-item" *ngFor="let item of cartItems">
        <div class="item-details">
          <span class="item-name">{{ item.name }}</span>
          <span class="item-price">‚Çπ{{ item.price }} √ó {{ item.quantity }}</span>
        </div>
        <div class="quantity-controls">
          <button class="qty-btn" (click)="updateQuantity(item.id, item.quantity - 1)">-</button>
          <span class="quantity">{{ item.quantity }}</span>
          <button class="qty-btn" (click)="updateQuantity(item.id, item.quantity + 1)">+</button>
          <button class="remove-btn" (click)="removeFromCart(item.id)">√ó</button>
        </div>
      </div>
    </div>
    <div class="cart-total">
      <strong>Total: ‚Çπ{{ getCartTotal() }}</strong>
    </div>
  </div>

  <div class="step-actions">
    <button class="btn btn-secondary" (click)="prevStep()">
      ‚Üê Back
    </button>
    <button 
      class="btn btn-primary" 
      [disabled]="cartItems.length === 0"
      (click)="nextStep()"
    >
      Proceed to Payment
      <span>‚Üí</span>
    </button>
  </div>
</div>


    <!-- Step 3: Customer Details & Payment -->
    <div *ngIf="currentStep === 3" class="payment-section">
      <div class="step-header">
        <h2>Complete Your Order</h2>
        <p>Enter your details and choose payment method</p>
      </div>

      <div class="payment-content">
        <!-- Customer Information -->
        <div class="customer-form">
          <h3>Delivery Information</h3>
          <div class="form-grid">
            <div class="form-group">
              <label for="customer-name">Full Name *</label>
              <input 
                type="text" 
                id="customer-name"
                [(ngModel)]="customerInfo.name"
                class="form-input"
                placeholder="Enter your full name"
                required
              />
            </div>
            
            <div class="form-group">
              <label for="customer-email">Email Address *</label>
              <input 
                type="email" 
                id="customer-email"
                [(ngModel)]="customerInfo.email"
                class="form-input"
                placeholder="Enter your email"
                required
              />
            </div>
            
            <div class="form-group">
              <label for="customer-phone">Phone Number *</label>
              <input 
                type="tel" 
                id="customer-phone"
                [(ngModel)]="customerInfo.phone"
                class="form-input"
                placeholder="Enter your phone number"
                required
              />
            </div>
            
            <div class="form-group full-width">
              <label for="customer-address">Delivery Address *</label>
              <textarea 
                id="customer-address"
                [(ngModel)]="customerInfo.address"
                class="form-textarea"
                rows="3"
                placeholder="Enter your complete delivery address"
                required
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Order Summary -->
        <div class="order-summary-card">
          <h3>Order Summary</h3>
          <div class="summary-details">
            <p><strong>Delivery Date:</strong> {{ selectedDate | date:'fullDate' }}</p>
            <div class="summary-items">
              <div class="summary-item" *ngFor="let item of cartItems">
                <span>{{ item.name }} √ó {{ item.quantity }}</span>
                <span>‚Çπ{{ item.price * item.quantity }}</span>
              </div>
            </div>
            <div class="summary-total">
              <strong>Total Amount: ‚Çπ{{ getCartTotal() }}</strong>
            </div>
          </div>
        </div>

        <!-- Payment Method Selection -->
        <div class="payment-methods">
          <h3>Choose Payment Method</h3>
          <div class="payment-options">
            <label class="payment-option">
              <input 
                type="radio" 
                name="paymentMethod" 
                value="online"
                [(ngModel)]="selectedPaymentMethod"
              />
              <div class="option-content">
                <div class="option-icon">üí≥</div>
                <div class="option-details">
                  <h4>Pay Online</h4>
                  <p>UPI, Credit/Debit Card</p>
                </div>
              </div>
            </label>
            
            <label class="payment-option">
              <input 
                type="radio" 
                name="paymentMethod" 
                value="cod"
                [(ngModel)]="selectedPaymentMethod"
              />
              <div class="option-content">
                <div class="option-icon">üíµ</div>
                <div class="option-details">
                  <h4>Cash on Delivery</h4>
                  <p>Pay when you receive</p>
                </div>
              </div>
            </label>
          </div>
        </div>
      </div>

      <div class="step-actions">
        <button class="btn btn-secondary" (click)="prevStep()">
          ‚Üê Back
        </button>
        <button 
          class="btn btn-primary payment-btn" 
          [disabled]="!isFormValid() || isProcessingPayment"
          (click)="processPayment()"
        >
          <span *ngIf="!isProcessingPayment">
            {{ selectedPaymentMethod === 'online' ? 'Pay Now' : 'Confirm Order' }}
            <span>‚Çπ{{ getCartTotal() }}</span>
          </span>
          <span *ngIf="isProcessingPayment">
            Processing...
          </span>
        </button>
      </div>
    </div>
  </div>
</div>